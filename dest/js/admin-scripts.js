(function(d){d(document).ready(function(){const l=wp.media({title:"Select an Image",button:{text:"Use this Image"},multiple:!1});s(),l.on("select",function(){let e=document.querySelector(".raffle_repeater__body.popup-open");if(!e)return;let t=e.querySelector(".raffle_img_item"),n=e.querySelector(".raffle_attachment_remove"),r=e.querySelector(".raffle_attachment_id"),a="",i=l.state().get("selection").first().toJSON();t.children.length?a=t.querySelector("img"):a=document.createElement("img"),a.src=i.url,a.alt=i.alt,a.setAttribute("width","350"),a.setAttribute("height","200"),a.style.objectFit="contain",t.children.length||t.appendChild(a),n&&n.classList.contains("hidden")&&n.classList.remove("hidden"),r&&(r.value=i.id),e.parentNode.classList.contains("popup-open")&&e.parentNode.classList.remove("popup-open")});const o=document.querySelector(".raffle_repeater__list"),c=document.querySelector(".raffle_media_add");o&&c&&c.addEventListener("click",function(){const e=document.createElement("div"),t=`
                <div class="raffle_repeater__body">
                    <p class="raffle_img_item"></p>
                    <span class="raffle_attachment_add button">Add image</span>
                    <span class="raffle_attachment_remove button hidden">Remove image</span>
                    <input type="hidden" class="raffle_attachment_id button" name="raffle_attachments[]" value="">
                </div>`;e.classList.add("raffle_repeater__item"),e.innerHTML=t,o.append(e),s()});function s(){const e=document.querySelectorAll(".raffle_repeater__body");e&&e.forEach(t=>{let n=t.querySelector(".raffle_img_item"),r=t.querySelector(".raffle_attachment_id"),a=t.querySelector(".raffle_attachment_add"),i=t.querySelector(".raffle_attachment_remove");!n||!r||!a||!i||(a&&a.addEventListener("click",function(){l&&(f(),this.parentNode.classList.contains("popup-open")||this.parentNode.classList.add("popup-open"),l.open())}),i&&i.addEventListener("click",function(){n&&(n.innerHTML=""),r&&(r.value=""),this.classList.add("hidden")}))})}function f(){document.querySelectorAll(".raffle_repeater__body").forEach(t=>{t.classList.contains("popup-open")&&t.classList.remove("popup-open")})}})})(jQuery);
